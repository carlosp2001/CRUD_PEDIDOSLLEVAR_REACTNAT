{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useReducer } from \"react\";\nimport UsuarioContext from \"./UsuarioContext\";\nimport UsuarioReducer from \"./UsuarioReducer\";\nimport Axios from \"../componentes/Axios\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar UsuarioState = function UsuarioState(props, _ref) {\n  var navigation = _ref.navigation;\n  var incialState = {\n    usuario: null,\n    token: null,\n    errores: [],\n    msj: \"\"\n  };\n\n  var _useReducer = useReducer(UsuarioReducer, incialState),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      estado = _useReducer2[0],\n      dispath = _useReducer2[1];\n\n  var getUser = function getUser() {\n    dispath({\n      acciones: 'GET_USER'\n    });\n  };\n\n  var setLogin = function _callee(data) {\n    var textoMensaje, usuario, token;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            textoMensaje = null;\n            usuario = null;\n            token = null;\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(Axios.post('pedidos/autenticacion/login', {\n              usuario: data.usuario,\n              contrasena: data.contrasena\n            }).then(function (data) {\n              var json = data.data;\n\n              if (json.errores.length == 0) {\n                usuario = json.datos.usuario;\n                token = json.datos.token;\n                textoMensaje = 'Bienvenido ' + usuario.LoginUsuario;\n                console.log(token);\n              } else {\n                textoMensaje = '';\n                json.errores.forEach(function (element) {\n                  textoMensaje += element.mensaje + '. ';\n                });\n              }\n            }).catch(function (error) {\n              textoMensaje = error;\n            }));\n\n          case 6:\n            _context.next = 12;\n            break;\n\n          case 8:\n            _context.prev = 8;\n            _context.t0 = _context[\"catch\"](0);\n            textoMensaje = _context.t0;\n            console.log(_context.t0);\n\n          case 12:\n            dispath({\n              datos: {\n                usuario: usuario,\n                token: token,\n                msj: textoMensaje,\n                errores: []\n              },\n              acciones: 'SET_LOGIN'\n            });\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 8]], Promise);\n  };\n\n  return _jsx(UsuarioContext.Provider, {\n    value: {\n      usuario: estado.usuario,\n      token: estado.token,\n      msj: estado.msj,\n      getUser: getUser,\n      setLogin: setLogin\n    },\n    children: props.children\n  });\n};\n\nexport default UsuarioState;","map":{"version":3,"names":["React","useReducer","UsuarioContext","UsuarioReducer","Axios","UsuarioState","props","navigation","incialState","usuario","token","errores","msj","estado","dispath","getUser","acciones","setLogin","data","textoMensaje","post","contrasena","then","json","length","datos","LoginUsuario","console","log","forEach","element","mensaje","catch","error","children"],"sources":["/Users/carlospineda/Downloads/Proyecto React/src/contexto/UsuarioState.js"],"sourcesContent":["import React, { useReducer} from \"react\"\nimport UsuarioContext from \"./UsuarioContext\"\nimport UsuarioReducer from \"./UsuarioReducer\"\nimport Axios from \"../componentes/Axios\";\n\nconst UsuarioState = (props, {navigation}) => {\n    const incialState = {\n        usuario: null,\n        token: null,\n        errores: [],\n        msj: \"\"\n    }\n    const [estado, dispath] = useReducer(UsuarioReducer, incialState)\n    const getUser = () => {\n        dispath({\n            acciones: 'GET_USER',\n        });\n    }\n    const setLogin = async (data) => {\n        try {\n            var textoMensaje=null;\n            var usuario= null;\n            var token= null;\n            await Axios.post('pedidos/autenticacion/login',{\n                usuario: data.usuario,\n                contrasena: data.contrasena\n            })\n            .then((data)=>{\n                const json=data.data;\n                if(json.errores.length==0){\n                    usuario = json.datos.usuario;\n                    token= json.datos.token;\n                    textoMensaje = 'Bienvenido ' + usuario.LoginUsuario;\n                    console.log(token);\n                }\n                else{\n                    textoMensaje='';\n                    json.errores.forEach(element => {\n                        textoMensaje+= element.mensaje + '. ';\n                    });\n                }\n            })\n            .catch((error)=>{\n                textoMensaje=error;\n            });\n        } catch (error) {\n            textoMensaje=error;\n            console.log(error);\n        }\n        dispath({\n            datos: {\n                usuario: usuario, \n                token:token,\n                msj: textoMensaje,\n                errores: [] \n            },\n            acciones: 'SET_LOGIN',\n        });\n    }\n    return(\n        <UsuarioContext.Provider value={{\n            usuario: estado.usuario,\n            token: estado.token,\n            msj: estado.msj,\n            getUser,\n            setLogin\n        }}>\n            {props.children}\n        </UsuarioContext.Provider>\n    )\n}\nexport default UsuarioState;\n"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,QAAiC,OAAjC;AACA,OAAOC,cAAP;AACA,OAAOC,cAAP;AACA,OAAOC,KAAP;;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,QAAyB;EAAA,IAAhBC,UAAgB,QAAhBA,UAAgB;EAC1C,IAAMC,WAAW,GAAG;IAChBC,OAAO,EAAE,IADO;IAEhBC,KAAK,EAAE,IAFS;IAGhBC,OAAO,EAAE,EAHO;IAIhBC,GAAG,EAAE;EAJW,CAApB;;EAMA,kBAA0BX,UAAU,CAACE,cAAD,EAAiBK,WAAjB,CAApC;EAAA;EAAA,IAAOK,MAAP;EAAA,IAAeC,OAAf;;EACA,IAAMC,OAAO,GAAG,SAAVA,OAAU,GAAM;IAClBD,OAAO,CAAC;MACJE,QAAQ,EAAE;IADN,CAAD,CAAP;EAGH,CAJD;;EAKA,IAAMC,QAAQ,GAAG,iBAAOC,IAAP;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAELC,YAFK,GAEQ,IAFR;YAGLV,OAHK,GAGI,IAHJ;YAILC,KAJK,GAIE,IAJF;YAAA;YAAA,iCAKHN,KAAK,CAACgB,IAAN,CAAW,6BAAX,EAAyC;cAC3CX,OAAO,EAAES,IAAI,CAACT,OAD6B;cAE3CY,UAAU,EAAEH,IAAI,CAACG;YAF0B,CAAzC,EAILC,IAJK,CAIA,UAACJ,IAAD,EAAQ;cACV,IAAMK,IAAI,GAACL,IAAI,CAACA,IAAhB;;cACA,IAAGK,IAAI,CAACZ,OAAL,CAAaa,MAAb,IAAqB,CAAxB,EAA0B;gBACtBf,OAAO,GAAGc,IAAI,CAACE,KAAL,CAAWhB,OAArB;gBACAC,KAAK,GAAEa,IAAI,CAACE,KAAL,CAAWf,KAAlB;gBACAS,YAAY,GAAG,gBAAgBV,OAAO,CAACiB,YAAvC;gBACAC,OAAO,CAACC,GAAR,CAAYlB,KAAZ;cACH,CALD,MAMI;gBACAS,YAAY,GAAC,EAAb;gBACAI,IAAI,CAACZ,OAAL,CAAakB,OAAb,CAAqB,UAAAC,OAAO,EAAI;kBAC5BX,YAAY,IAAGW,OAAO,CAACC,OAAR,GAAkB,IAAjC;gBACH,CAFD;cAGH;YACJ,CAlBK,EAmBLC,KAnBK,CAmBC,UAACC,KAAD,EAAS;cACZd,YAAY,GAACc,KAAb;YACH,CArBK,CALG;;UAAA;YAAA;YAAA;;UAAA;YAAA;YAAA;YA4BTd,YAAY,cAAZ;YACAQ,OAAO,CAACC,GAAR;;UA7BS;YA+Bbd,OAAO,CAAC;cACJW,KAAK,EAAE;gBACHhB,OAAO,EAAEA,OADN;gBAEHC,KAAK,EAACA,KAFH;gBAGHE,GAAG,EAAEO,YAHF;gBAIHR,OAAO,EAAE;cAJN,CADH;cAOJK,QAAQ,EAAE;YAPN,CAAD,CAAP;;UA/Ba;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAjB;;EAyCA,OACI,KAAC,cAAD,CAAgB,QAAhB;IAAyB,KAAK,EAAE;MAC5BP,OAAO,EAAEI,MAAM,CAACJ,OADY;MAE5BC,KAAK,EAAEG,MAAM,CAACH,KAFc;MAG5BE,GAAG,EAAEC,MAAM,CAACD,GAHgB;MAI5BG,OAAO,EAAPA,OAJ4B;MAK5BE,QAAQ,EAARA;IAL4B,CAAhC;IAAA,UAOKX,KAAK,CAAC4B;EAPX,EADJ;AAWH,CAjED;;AAkEA,eAAe7B,YAAf"},"metadata":{},"sourceType":"module"}